<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="720" viewBox="0 0 1280 720">
  <defs>
    <style>
      .box{fill:#f8fafc;stroke:#cbd5e1;stroke-width:2;}
      .title{font:700 18px system-ui,Segoe UI,Roboto,Helvetica,Arial;fill:#0f172a;}
      .item{font:600 16px system-ui,Segoe UI,Roboto,Helvetica,Arial;fill:#334155;}
      .sub{font:400 13px system-ui,Segoe UI,Roboto,Helvetica,Arial;fill:#64748b;}
    </style>
  </defs>
  <rect x="20" y="20" width="1240" height="680" fill="#ffffff" stroke="#e5e7eb" rx="16"/>

  <!-- Layer 1: Runtime Events -->
  <rect class="box" x="40" y="40" width="1200" height="120" rx="12"/>
  <text class="title" x="60" y="70">运行时事件层</text>
  <rect class="box" x="60" y="85" width="560" height="60" rx="12"/>
  <text class="item" x="80" y="112">Falco Daemon</text>
  <text class="sub"  x="80" y="130">内核/容器事件采集，规则评估，JSON 输出，健康探针</text>
  <rect class="box" x="640" y="85" width="560" height="60" rx="12"/>
  <text class="item" x="660" y="112">日志采集 Agent（DockerLogQueue）</text>
  <text class="sub"  x="660" y="130">stdout 增量拉取，队列缓冲与背压</text>

  <!-- Layer 2: Behavior Modeling -->
  <rect class="box" x="40" y="180" width="1200" height="130" rx="12"/>
  <text class="title" x="60" y="210">行为建模层</text>
  <rect class="box" x="60" y="225" width="1120" height="70" rx="12"/>
  <text class="item" x="80" y="252">Hanabi Worker</text>
  <text class="sub"  x="80" y="270">事件解析/分类、HBT 行为画像、预热/检测、语义匹配与告警候选</text>

  <!-- Layer 3: Data Services -->
  <rect class="box" x="40" y="330" width="1200" height="160" rx="12"/>
  <text class="title" x="60" y="360">数据服务层</text>
  <rect class="box" x="60" y="375" width="370" height="95" rx="12"/>
  <text class="item" x="80" y="405">Prometheus Metrics Exporter</text>
  <text class="sub"  x="80" y="425">事件/告警映射为指标，统一标签维度，/metrics 暴露</text>
  <rect class="box" x="450" y="375" width="370" height="95" rx="12"/>
  <text class="item" x="470" y="405">Prometheus TSDB</text>
  <text class="sub"  x="470" y="425">时序存储与查询，PromQL/HTTP API</text>
  <rect class="box" x="840" y="375" width="340" height="95" rx="12"/>
  <text class="item" x="860" y="405">HBT 快照存储/缓存</text>
  <text class="sub"  x="860" y="425">画像结构与告警明细快速访问</text>

  <!-- Layer 4: Application -->
  <rect class="box" x="40" y="510" width="1200" height="160" rx="12"/>
  <text class="title" x="60" y="540">应用层</text>
  <rect class="box" x="60" y="555" width="560" height="95" rx="12"/>
  <text class="item" x="80" y="585">API Gateway（REST + SSE/WebSocket）</text>
  <text class="sub"  x="80" y="605">PromQL 封装与缓存，画像/告警查询与实时推送</text>
  <rect class="box" x="640" y="555" width="560" height="95" rx="12"/>
  <text class="item" x="660" y="585">前端控制台 &amp; Grafana（选配）</text>
  <text class="sub"  x="660" y="605">总览/容器日志/告警分页、HBT 侧栏、面板复用</text>

  <!-- Arrows (indicative) -->
  <text class="sub" x="60" y="170">事件流 → 队列消费</text>
  <text class="sub" x="60" y="320">画像/告警 → 指标映射 &amp; 快照写入</text>
  <text class="sub" x="60" y="500">API 查询 TSDB/快照；前端订阅实时流</text>
</svg>
